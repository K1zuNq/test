<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>学力テスト</title>

<style>
body{
    font-family:sans-serif;
    margin:20px;
    line-height:1.6;
    user-select:none;
}
h1{text-align:center;}
.section{margin-top:40px;}
textarea{width:100%;height:70px;}
input[type="text"]{width:100%;}
.warning{color:red;font-weight:bold;}
input,textarea{user-select:text;}
button{padding:10px 20px;font-size:18px;background:#4CAF50;color:white;border:none;border-radius:5px;}
#timer{font-size:24px;color:red;font-weight:bold;text-align:center;margin-bottom:15px;}
</style>

<script>
// ===== コピペ対策 =====
document.addEventListener("copy", e => e.preventDefault());
document.addEventListener("paste", e => e.preventDefault());
document.addEventListener("cut", e => e.preventDefault());
document.addEventListener("contextmenu", e => e.preventDefault());
document.addEventListener("selectstart", e => e.preventDefault());
document.addEventListener("keydown", function(e){
    if(e.ctrlKey || e.metaKey){
        if(["c","v","x","u","s","a","p"].includes(e.key.toLowerCase())){
            e.preventDefault();
        }
    }
    if(e.key === "F12") e.preventDefault();
});

// ===== 離脱警告 =====
document.addEventListener("visibilitychange", function(){
    if(document.hidden){
        alert("画面を離れました。不正の可能性があります。");
    }
});

// ===== タイマー =====
let time = 1800;
function countdown(){
    let min = Math.floor(time / 60);
    let sec = time % 60;
    document.getElementById("timer").textContent = "残り時間: " + min + "分 " + sec + "秒";
    time--;
    if(time >= 0) setTimeout(countdown, 1000);
}
window.onload = countdown;
</script>

</head>
<body>

<h1>学力テスト</h1>
<p id="timer"></p>
<p class="warning">制限時間 30 分 / コピペ禁止 / 不正検知あり</p>

<!-- 名前 -->
<div>
<p>名前（必須）</p>
<input type="text" id="name">
</div>

<!-- 国語 -->
<div class="section">
<h2>【国語】20点</h2>

<p>① 「客観」の意味を簡潔に答えよ。</p><textarea id="q1"></textarea>
<p>② 「抽象」の意味を説明せよ。</p><textarea id="q2"></textarea>
<p>③ 対義語を書け。「拡大」</p><input id="q3" type="text">
<p>④ 主語を答えよ。<br>「彼が書いた小説は多くの人に読まれている。」</p><input id="q4" type="text">
<p>⑤ 品詞を答えよ。「静かに」</p><input id="q5" type="text">
<p>⑥ 比喩の種類を答えよ。<br>「彼はライオンのように勇敢だ。」</p><input id="q6" type="text">
<p>⑦ 「臨機応変」の意味を書け。</p><textarea id="q7"></textarea>
<p>⑧ 敬語に直せ。「先生が言った。」</p><textarea id="q8"></textarea>
<p>⑨ 接続詞を入れよ。<br>「＿＿＿、彼は諦めなかった。」</p><input id="q9" type="text">
<p>⑩ 「石の上にも三年」を使って例文を作れ。</p><textarea id="q10"></textarea>
</div>

<!-- 数学 -->
<div class="section">
<h2>【数学】20点</h2>

<p>① 7×8＝</p><input id="q11" type="text">
<p>② 12−5＝</p><input id="q12" type="text">
<p>③ 3x + 5 = 20 を解け。</p><input id="q13" type="text">
<p>④ (x+2)(x-3) を展開せよ。</p><input id="q14" type="text">
<p>⑤ √50 を簡単にせよ。</p><input id="q15" type="text">
<p>⑥ y=x² の頂点。</p><input id="q16" type="text">
<p>⑦ サイコロ1回。偶数の確率。</p><input id="q17" type="text">
<p>⑧ 連立方程式 x+y=10, x−y=2 を解け。</p><input id="q18" type="text">
<p>⑨ 半径3cmの円の面積。</p><input id="q19" type="text">
<p>⑩ 2kgに10N。加速度。</p><input id="q20" type="text">
</div>

<!-- 英語 -->
<div class="section">
<h2>【英語】20点</h2>

<p>① important の意味</p><input id="q21" type="text">
<p>② I was very ( ) because I lost my wallet. (a)happy (b)sad (c)fast</p><input id="q22" type="text">
<p>③ She go to school every day. を直せ。</p><input id="q23" type="text">
<p>④ I have lived here ( ) three years. (a)since (b)for</p><input id="q24" type="text">
<p>⑤ (play / I / tennis / every Sunday) 並び替え</p><input id="q25" type="text">
<p>⑥ The more you practice, the better you become. 和訳</p><textarea id="q26"></textarea>
<p>⑦ 「彼は私より背が高い。」英訳</p><input id="q27" type="text">
<p>⑧ 受動態にせよ。People speak English all over the world.</p><input id="q28" type="text">
<p>⑨ 「私は昨日図書館で勉強した。」英訳</p><input id="q29" type="text">
<p>⑩ Not all students like math. 和訳</p><textarea id="q30"></textarea>
</div>

<!-- 理科 -->
<div class="section">
<h2>【理科】20点</h2>

<p>① 光合成で作られる養分</p><input id="q31" type="text">
<p>② 酸素を運ぶ血液成分</p><input id="q32" type="text">
<p>③ 水の化学式</p><input id="q33" type="text">
<p>④ 酸性水溶液の性質1つ</p><input id="q34" type="text">
<p>⑤ 力の単位</p><input id="q35" type="text">
<p>⑥ 速さの公式</p><input id="q36" type="text">
<p>⑦ 地震の最初の波</p><input id="q37" type="text">
<p>⑧ 月の満ち欠けの理由</p><textarea id="q38"></textarea>
<p>⑨ F=ma で加速度（2kg,10N）</p><input id="q39" type="text">
<p>⑩ 金属が電気を通す理由</p><textarea id="q40"></textarea>
</div>

<!-- 社会 -->
<div class="section">
<h2>【社会】20点</h2>

<p>① 太平洋ベルトに工業が集中した理由</p><textarea id="q41"></textarea>
<p>② 気候が異なる理由（緯度・季節風）</p><textarea id="q42"></textarea>
<p>③ 排他的経済水域（3文字）</p><input id="q43" type="text">
<p>④ 鎌倉幕府成立年</p><input id="q44" type="text">
<p>⑤ 明治維新の変化</p><textarea id="q45"></textarea>
<p>⑥ 鎖国の目的</p><textarea id="q46"></textarea>
<p>⑦ 憲法9条の内容</p><textarea id="q47"></textarea>
<p>⑧ 衆議院の優越の理由</p><textarea id="q48"></textarea>
<p>⑨ 内閣の国会への責任制度名</p><input id="q49" type="text">
<p>⑩ 少子高齢化の影響</p><textarea id="q50"></textarea>
</div>

<!-- 提出 -->
<button onclick="submitTest()">提出</button>

<script>
async function submitTest(){
    const payload = {
        name: document.getElementById("name").value,
        answer: [
            q1.value, q2.value, q3.value, q4.value, q5.value,
            q6.value, q7.value, q8.value, q9.value, q10.value,
            q11.value, q12.value, q13.value, q14.value, q15.value,
            q16.value, q17.value, q18.value, q19.value, q20.value,
            q21.value, q22.value, q23.value, q24.value, q25.value,
            q26.value, q27.value, q28.value, q29.value, q30.value,
            q31.value, q32.value, q33.value, q34.value, q35.value,
            q36.value, q37.value, q38.value, q39.value, q40.value,
            q41.value, q42.value, q43.value, q44.value, q45.value,
            q46.value, q47.value, q48.value, q49.value, q50.value
        ].join(" / ")
    };
    await fetch("https://script.google.com/macros/s/AKfycbza6LieKzkRhYYY06fK3qSpDdmBZlah-2B3VKj3TmiFE6m7bWI5_YPPsp8BmxPPWqlc3A/exec", {
        method:"POST",
        body:JSON.stringify(payload)
    });
    alert("提出完了！スプレッドシートに送信されました。");
}
</script>

</body>
</html>
