<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>学力テスト</title>

<style>
body{
    font-family:sans-serif;
    margin:20px;
    line-height:1.6;
    user-select:none;
}
h1{text-align:center;}
.section{margin-top:30px;}
textarea{width:100%;height:60px;}
input[type="text"]{width:100%;}
.timer{
    position:fixed;
    top:10px;
    right:20px;
    font-size:24px;
    font-weight:bold;
}
button{
    margin-top:20px;
    padding:10px 20px;
    font-size:16px;
}
</style>
</head>

<body oncontextmenu="return false">
<h1>学力テスト（制限時間30分）</h1>
<div class="timer" id="timer">30:00</div>

名前：
<input type="text" id="name">

<!-- 国語 -->
<div class="section">
<h2>【国語】20点</h2>
<textarea id="kokugo"></textarea>
</div>

<!-- 数学 -->
<div class="section">
<h2>【数学】20点</h2>
<textarea id="sugaku"></textarea>
</div>

<!-- 英語 -->
<div class="section">
<h2>【英語】20点</h2>
<textarea id="eigo"></textarea>
</div>

<!-- 理科（易しめ） -->
<div class="section">
<h2>【理科】20点</h2>
<textarea id="rika">
① 光合成に必要なものを3つ書け。
② 水の沸点は何度か。
③ 電流の単位は何か。
④ 地震の揺れを記録する機械は何か。
⑤ 月が光って見える理由を書け。
</textarea>
</div>

<!-- 社会（易しめ） -->
<div class="section">
<h2>【社会】20点</h2>
<textarea id="shakai">
① 太平洋ベルトとは何か。
② 日本の首都はどこか。
③ 三権分立の3つを答えよ。
④ 鎌倉幕府が成立した年。
⑤ 日本国憲法が施行された年。
</textarea>
</div>

<button onclick="submitTest()">提出</button>

<script>
let startTime = new Date().getTime();
let timeLeft = 1800;

let timerInterval = setInterval(function(){
    timeLeft--;
    let minutes = Math.floor(timeLeft/60);
    let seconds = timeLeft%60;
    document.getElementById("timer").innerText =
        String(minutes).padStart(2,"0")+":"+
        String(seconds).padStart(2,"0");

    if(timeLeft<=0){
        clearInterval(timerInterval);
        submitTest();
    }
},1000);

async function submitTest(){

    const endTime = new Date().getTime();
    const elapsed = Math.floor((endTime - startTime)/1000);

    const payload = {
        name: document.getElementById("name").value,
        kokugo: document.getElementById("kokugo").value,
        sugaku: document.getElementById("sugaku").value,
        eigo: document.getElementById("eigo").value,
        rika: document.getElementById("rika").value,
        shakai: document.getElementById("shakai").value,
        time: elapsed + "秒"
    };

    try{
        await fetch("https://script.google.com/macros/s/AKfycbwPydCBXtGZ88idbCYcryMG4Ix0t70kjeilp9H9182madOa5ihAayNAjpIX_ZG8mRDtXg/exec",{
            method:"POST",
            headers:{
                "Content-Type":"application/json"
            },
            body:JSON.stringify(payload)
        });

        alert("送信しました！");
    }catch(error){
        alert("送信エラー："+error);
    }
}

document.onkeydown = function(e){
    if(e.keyCode==123){return false;}
};
</script>

</body>
</html>
